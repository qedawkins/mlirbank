#~/iree-build/tools/iree-compile models/llama2_70b_folded.mlir \
~/iree-build/tools/iree-compile models/llama2_7b_folded.mlir \
    --iree-vulkan-target-triple=rdna3-unknown-linux \
    --iree-llvmcpu-target-triple=x86_64-unknown-linux \
    --iree-hal-cuda-llvm-target-arch=sm_80 \
    --iree-rocm-target-chip=gfx1100 \
    --iree-stream-resource-index-bits=64 \
    --iree-vm-target-index-bits=64 \
    --iree-input-type=none \
    --iree-stream-resource-max-allocation-size=4294967295 \
    --iree-rocm-link-bc=true \
    --iree-rocm-bc-dir=/opt/rocm/amdgcn/bitcode \
    --iree-hal-target-backends=rocm \
    --iree-hal-dump-executable-sources-to=sources \
    --iree-hal-dump-executable-binaries-to=binaries \
    -o /tmp/dispatch.vmfb

TRACY_NO_EXIT=1 ~/iree-build/tools/iree-benchmark-module --device=rocm --function=second_vicuna_forward \
  --module=/tmp/dispatch.vmfb \
  --benchmark_repetitions=10 \
  --input=1x1xi64 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16 \
  --input=1x32x1x128xf16
